<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba de Voces ElevenLabs</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .voice-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            background: #f9f9f9;
        }
        .voice-card h3 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }
        .voice-id {
            font-family: monospace;
            background: #e8e8e8;
            padding: 5px;
            border-radius: 4px;
            font-size: 12px;
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #2980b9;
        }
        button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .status.generating {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }
        .status.playing {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .status.error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .instructions {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéôÔ∏è Prueba de Voces ElevenLabs</h1>
        
        <div class="instructions">
            <h3>üìã Instrucciones:</h3>
            <ol>
                <li>Haz clic en "Probar" para escuchar cada voz</li>
                <li>Elige la que m√°s te guste</li>
                <li>Copia el Voice ID de la voz elegida</li>
                <li>Actualiza tu archivo .env con el nuevo Voice ID</li>
                <li>Reinicia el servidor</li>
            </ol>
        </div>

        <div id="status" class="status" style="display: none;"></div>

        <div class="voice-card">
            <h3>üë© Rachel (Recomendada - Femenina)</h3>
            <div class="voice-id">21m00Tcm4TlvDq8ikWAM</div>
            <p>Voz femenina clara, perfecta para espa√±ol nativo</p>
            <button onclick="testVoice('21m00Tcm4TlvDq8ikWAM', 'Rachel')">Probar Rachel</button>
        </div>

        <div class="voice-card">
            <h3>üë® Adam (Recomendada - Masculina)</h3>
            <div class="voice-id">pNInz6obpgDQGcFmaJgB</div>
            <p>Voz masculina clara, excelente pronunciaci√≥n en espa√±ol</p>
            <button onclick="testVoice('pNInz6obpgDQGcFmaJgB', 'Adam')">Probar Adam</button>
        </div>

        <div class="voice-card">
            <h3>üë© Domi (Femenina Joven)</h3>
            <div class="voice-id">AZnzlk1XvdvUeBnXmlld</div>
            <p>Voz femenina joven, muy natural</p>
            <button onclick="testVoice('AZnzlk1XvdvUeBnXmlld', 'Domi')">Probar Domi</button>
        </div>

        <div class="voice-card">
            <h3>üë© Elli (Femenina Suave)</h3>
            <div class="voice-id">MF3mGyEYCl7XYWbV9V6O</div>
            <p>Voz femenina suave, excelente pronunciaci√≥n</p>
            <button onclick="testVoice('MF3mGyEYCl7XYWbV9V6O', 'Elli')">Probar Elli</button>
        </div>

        <div class="voice-card">
            <h3>üë® Arnold (Masculina Profunda)</h3>
            <div class="voice-id">VR6AewLTigWG4xSOukaG</div>
            <p>Voz masculina profunda, muy natural</p>
            <button onclick="testVoice('VR6AewLTigWG4xSOukaG', 'Arnold')">Probar Arnold</button>
        </div>

        <div class="voice-card">
            <h3>üë® Sam (Masculina Joven)</h3>
            <div class="voice-id">yoZ06aMxZJJ28mfd3POQ</div>
            <p>Voz masculina joven, muy natural</p>
            <button onclick="testVoice('yoZ06aMxZJJ28mfd3POQ', 'Sam')">Probar Sam</button>
        </div>

        <div class="voice-card">
            <h3>üë® Josh (Masculina Clara)</h3>
            <div class="voice-id">TxGEqnHWrfWFTfGW9XjX</div>
            <p>Voz masculina clara</p>
            <button onclick="testVoice('TxGEqnHWrfWFTfGW9XjX', 'Josh')">Probar Josh</button>
        </div>

        <div class="voice-card" style="border-color: #e74c3c;">
            <h3>üë© Bella (Actual - No Recomendada)</h3>
            <div class="voice-id">EXAVITQu4vr4xnSDxMaL</div>
            <p>Voz femenina actual - no suena como espa√±ol nativo</p>
            <button onclick="testVoice('EXAVITQu4vr4xnSDxMaL', 'Bella')">Probar Bella (Actual)</button>
        </div>
    </div>

    <script>
        const API_KEY = 'sk_dd0d1757269405cd26d5e22fb14c54d2f49c4019fd8e86d0';
        const MODEL_ID = 'eleven_multilingual_v2';
        
        let currentAudio = null;

        function showStatus(message, type) {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
            status.style.display = 'block';
        }

        function hideStatus() {
            const status = document.getElementById('status');
            status.style.display = 'none';
        }

        async function testVoice(voiceId, voiceName) {
            // Stop any current audio
            if (currentAudio) {
                currentAudio.pause();
                currentAudio = null;
            }

            showStatus(`üîÑ Generando audio con ${voiceName}...`, 'generating');

            const testText = "Hola, soy " + voiceName + ". Esta es una prueba de voz en espa√±ol. ¬øC√≥mo me escuchas? ¬øSueno natural y nativo? Espero que te guste mi pronunciaci√≥n.";

            try {
                const response = await fetch(
                    `https://api.elevenlabs.io/v1/text-to-speech/${voiceId}/stream`,
                    {
                        method: 'POST',
                        headers: {
                            'Accept': 'audio/mpeg',
                            'Content-Type': 'application/json',
                            'xi-api-key': API_KEY,
                        },
                        body: JSON.stringify({
                            text: testText,
                            model_id: MODEL_ID,
                            voice_settings: {
                                stability: 0.6,
                                similarity_boost: 0.8,
                                style: 0.1,
                                use_speaker_boost: true,
                            },
                        }),
                    }
                );

                if (!response.ok) {
                    throw new Error(`Error: ${response.status}`);
                }

                const audioBlob = await response.blob();
                const audioUrl = URL.createObjectURL(audioBlob);
                
                currentAudio = new Audio(audioUrl);
                
                currentAudio.oncanplaythrough = () => {
                    showStatus(`üéôÔ∏è Reproduciendo ${voiceName}...`, 'playing');
                };

                currentAudio.onended = () => {
                    showStatus(`‚úÖ ${voiceName} termin√≥ de hablar`, 'playing');
                    URL.revokeObjectURL(audioUrl);
                    currentAudio = null;
                };

                currentAudio.onerror = (e) => {
                    showStatus(`‚ùå Error al reproducir ${voiceName}`, 'error');
                    URL.revokeObjectURL(audioUrl);
                    currentAudio = null;
                };

                await currentAudio.play();

            } catch (error) {
                console.error('Error:', error);
                showStatus(`‚ùå Error: ${error.message}`, 'error');
            }
        }

        // Clean up on page unload
        window.addEventListener('beforeunload', () => {
            if (currentAudio) {
                currentAudio.pause();
            }
        });
    </script>
</body>
</html>
